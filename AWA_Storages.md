## Introduction ##
The <b>Storages</b> module provides a set of storage services allowing an application
to store data files, documents, images in a persistent area.  The persistent store can
be on a file system, in the database or provided by a remote service such as
Amazon Simple Storage Service.

## Creating a storage ##
A data in the storage is represented by a `Storage_Ref` instance.  The data itself
can be physically stored in a file system (`FILE` mode), in the database (`DATABASE`
mode) or on a remote server (`URL` mode).  To put a file in the storage space, first create
the storage object instance:

```
  Data : AWA.Storages.Models.Storage_Ref;
```

Then setup the storage mode that you want.  The storage service uses this information
to save the data in a file, in the database or in a remote service (in the future).
To save a file in the store, we can use the `Save` operation of the storage service.
It will read the file and put in in the corresponding persistent store (the database
in this example).

```
  Service.Save (Into => Data, Path => Path_To_The_File,
                Storage => AWA.Storages.Models.DATABASE);
```

Upon successful completion, the storage instance `Data` will be allocated a unique
identifier that can be retrieved by `Get_Id` or `Get_Key`.

## Getting the data ##
Several operations are defined to retrieve the data.  Each of them has been designed
to optimize the retrieval and

  * The data can be retrieved in a local file. This mode is useful if an external program must be launched and be able to read the file.  If the storage mode of the data is `FILE`, the path of the file on the storage file system is used.  For other storage modes, the file is saved in a temporary file.  In that case the `Store_Local` database table is used to track such locally saved data.

  * The data can be returned as a stream. When the application has to read the data, opening a read stream connection is the most efficient mechanism.

### Local file ###
To access the data by using a local file, we must define a local storage reference:

```
  Data : AWA.Storages.Models.Store_Local_Ref;
```

and use the `Load` operation with the storage identifier.  When loading locally we
also indicate whether the file will be read or written.  A file that is in `READ` mode
can be shared by several tasks or processes.  A file that is in `WRITE` mode will have
a specific copy for the caller.  An optional expiration parameter indicate when the
local file representation can expire.

```
  Service.Load (From => Id, Into => Data, Mode => READ, Expire => ONE_DAY);
```

Once the load operation succeeded, the data is stored on the file system and
the local path is obtained by using the `Get_Path` operation:

```
  Path : constant String := Data.Get_Path;
```

## Ada Beans ##
<table width='100%'>
<tr>
<th width='30%' align='left'>Name</th>
<th width='70%' align='left'>Description</th>
</tr>
<tr>
<td>storageFolder</td>
<td>This bean allows to create a storage folder.</td>
</tr>
<tr>
<td>uploadFile</td>
<td>This bean allows to upload a new file in the storage space.</td>
</tr>
<tr>
<td>folderList</td>
<td>This bean gives the list of storage folders in the workspace.</td>
</tr>
<tr>
<td>storageList</td>
<td>This bean gives the list of storage files associated with a given folder.</td>
</tr>
</table><h3>Permissions</h3><table width='100%'>
<tr>
<th width='20%' align='left'>Name</th>
<th width='10%' align='left'>Name</th>
<th width='70%' align='left'>Description</th>
</tr>
<tr>
<td>folder-create</td>
<td>awa_workspace</td>
<td></td>
</tr>
<tr>
<td>storage-create</td>
<td>awa_workspace</td>
<td></td>
</tr>
<tr>
<td>storage-delete</td>
<td>awa_workspace</td>
<td></td>
</tr>
</table><h3>Configuration</h3><table width='100%'>
<tr>
<th width='30%' align='left'>Name</th>
<th width='70%' align='left'>Description</th>
</tr>
<tr>
<td>storages.rootdir</td>
<td></td>
</tr>
<tr>
<td></td>
<td><tt>storage-root</tt></td>
</tr>
</table>


## Model ##
![http://ada-awa.googlecode.com/svn/wiki/awa_storage_model.png](http://ada-awa.googlecode.com/svn/wiki/awa_storage_model.png)



---

[Generated by Dynamo](http://code.google.com/p/ada-gen) _from awa-storages.ads_