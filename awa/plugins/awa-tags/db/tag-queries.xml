<query-mapping package='AWA.Tags.Models'>
    <description>
      Queries used by the tags module
    </description>

    <query name='check-tag'>
       <comment>Check and get the tag identifier associated with a given tag and entity</comment>
       <sql>
    SELECT
      t.id, e.id
    FROM awa_tag AS t
    LEFT JOIN awa_tagged_entity AS e ON t.id = e.tag_id
       AND e.entity_type = :entity_type AND e.for_entity_id = :entity_id
    WHERE t.name = :tag
       </sql>
    </query>

    <query name='tag-list'>
       <comment>Get the list of tags associated with a given database entity</comment>
       <sql>
    SELECT
      t.name
    FROM awa_tagged_entity AS e
    INNER JOIN awa_tag AS t ON t.id = e.tag_id
    WHERE e.entity_type = :entity_type AND e.for_entity_id = :entity_id
       </sql>
    </query>
    
</query-mapping>
